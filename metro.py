import requests, json

ids = [
("Abrantes","MadridStation_Abrantes"),
("Acacias","MadridStation_Acacias"),
("AeropuertoT1T2T3","MadridStation_AeropuertoT1T2T3"),
("AeropuertoT4","MadridStation_AeropuertoT4"),
("AlamedaDeOsuna","MadridStation_AlamedaDeOsuna"),
("AlcorconCentral","MadridStation_AlcorconCentral"),
("AlonsoCano","MadridStation_AlonsoCano"),
("AlfonsoXiii","MadridStation_AlfonsoXiii"),
("Almendrales","MadridStation_Almendrales"),
("AlonsoDeMendoza","MadridStation_AlonsoDeMendoza"),
("AlonsoMartinez","MadridStation_AlonsoMartinez"),
("Alsacia","MadridStation_Alsacia"),
("AltoDeExtremadura","MadridStation_AltoDeExtremadura"),
("AltoDelArenal","MadridStation_AltoDelArenal"),
("Aluche","MadridStation_Aluche"),
("Alvarado","MadridStation_Alvarado"),
("AlvarezDeVillaamil","MadridStation_AlvarezDeVillaamil"),
("AntonMartin","MadridStation_AntonMartin"),
("AntonioMachado","MadridStation_AntonioMachado"),
("AntonioSaura","MadridStation_AntonioSaura"),
("ArgandaDelRey","MadridStation_ArgandaDelRey"),
("Arganzuelaplanetario","MadridStation_Arganzuelaplanetario"),
("Arguelles","MadridStation_Arguelles"),
("ArroyoCulebro","MadridStation_ArroyoCulebro"),
("Artilleros","MadridStation_Artilleros"),
("ArturoSoria","MadridStation_ArturoSoria"),
("Ascao","MadridStation_Ascao"),
("Atocha","MadridStation_Atocha"),
("Atocha","MadridStation_Atocha"),
("AvenidaDeAmerica","MadridStation_AvenidaDeAmerica"),
("AvenidaDeEuropa","MadridStation_AvenidaDeEuropa"),
("AvenidaDeGuadalajara","MadridStation_AvenidaDeGuadalajara"),
("AvenidaDeLaIlustracion","MadridStation_AvenidaDeLaIlustracion"),
("AvenidaDeLaPaz","MadridStation_AvenidaDeLaPaz"),
("AviacionEspanola","MadridStation_AviacionEspanola"),
("Bambu","MadridStation_Bambu"),
("BancoDeEspana","MadridStation_BancoDeEspana"),
("Barajas","MadridStation_Barajas"),
("BarrioDeLaConcepcion","MadridStation_BarrioDeLaConcepcion"),
("BarrioDelPilar","MadridStation_BarrioDelPilar"),
("BarrioDelPuerto","MadridStation_BarrioDelPuerto"),
("Batan","MadridStation_Batan"),
("Baunatal","MadridStation_Baunatal"),
("Begona","MadridStation_Begona"),
("Belgica","MadridStation_Belgica"),
("Berna","MadridStation_Berna"),
("Bilbao","MadridStation_Bilbao"),
("BlascoIbanez","MadridStation_BlascoIbanez"),
("BoadillaCentro","MadridStation_BoadillaCentro"),
("BuenosAires","MadridStation_BuenosAires"),
("Callao","MadridStation_Callao"),
("Campamento","MadridStation_Campamento"),
("CampoDeLasNaciones","MadridStation_CampoDeLasNaciones"),
("CampusDeSomosaguas","MadridStation_CampusDeSomosaguas"),
("Canal","MadridStation_Canal"),
("Canillas","MadridStation_Canillas"),
("Canillejas","MadridStation_Canillejas"),
("Cantabria","MadridStation_Cantabria"),
("Carabanchel","MadridStation_Carabanchel"),
("CarabanchelAlto","MadridStation_CarabanchelAlto"),
("Carpetana","MadridStation_Carpetana"),
("Cartagena","MadridStation_Cartagena"),
("CasaDeCampo","MadridStation_CasaDeCampo"),
("CasaDelReloj","MadridStation_CasaDelReloj"),
("Chamartin","MadridStation_Chamartin"),
("Chueca","MadridStation_Chueca"),
("CiudadDeLaImagen","MadridStation_CiudadDeLaImagen"),
("CiudadDeLosAngeles","MadridStation_CiudadDeLosAngeles"),
("CiudadDelCine","MadridStation_CiudadDelCine"),
("CiudadLineal","MadridStation_CiudadLineal"),
("CiudadUniversitaria","MadridStation_CiudadUniversitaria"),
("Cocheras","MadridStation_Cocheras"),
("Colombia","MadridStation_Colombia"),
("Colon","MadridStation_Colon"),
("ColoniaDeLosAngeles","MadridStation_ColoniaDeLosAngeles"),
("ColoniaJardin","MadridStation_ColoniaJardin"),
("ConchaEspina","MadridStation_ConchaEspina"),
("CondeDeCasal","MadridStation_CondeDeCasal"),
("Congosto","MadridStation_Congosto"),
("Conservatorio","MadridStation_Conservatorio"),
("CosladaCentral","MadridStation_CosladaCentral"),
("CruzDelRayo","MadridStation_CruzDelRayo"),
("CuatroCaminos","MadridStation_CuatroCaminos"),
("CuatroVientos","MadridStation_CuatroVientos"),
("Cuzco","MadridStation_Cuzco"),
("Delicias","MadridStation_Delicias"),
("DiegoDeLeon","MadridStation_DiegoDeLeon"),
("DosCastillas","MadridStation_DosCastillas"),
("DuqueDePastrana","MadridStation_DuqueDePastrana"),
("ElBercial","MadridStation_ElBercial"),
("ElCapricho","MadridStation_ElCapricho"),
("ElCarmen","MadridStation_ElCarmen"),
("ElCarrascal","MadridStation_ElCarrascal"),
("ElCasar","MadridStation_ElCasar"),
("Embajadores","MadridStation_Embajadores"),
("Empalme","MadridStation_Empalme"),
("Esperanza","MadridStation_Esperanza"),
("Aravaca","MadridStation_Aravaca"),
("EstadioOlimpico","MadridStation_EstadioOlimpico"),
("Estrecho","MadridStation_Estrecho"),
("Estrella","MadridStation_Estrella"),
("EugeniaDeMontijo","MadridStation_EugeniaDeMontijo"),
("FerialDeBoadilla","MadridStation_FerialDeBoadilla"),
("FrancosRodriguez","MadridStation_FrancosRodriguez"),
("Fuencarral","MadridStation_Fuencarral"),
("FuenlabradaCentral_madrid_renfe_osm_gtfs","MadridStation_FuenlabradaCentral_madrid_renfe_osm_gtfs"),
("FuenteDeLaMora","MadridStation_FuenteDeLaMora"),
("GarciaNoblejas","MadridStation_GarciaNoblejas"),
("GetafeCentral","MadridStation_GetafeCentral"),
("Goya","MadridStation_Goya"),
("GranVia","MadridStation_GranVia"),
("GregorioMaranon","MadridStation_GregorioMaranon"),
("GuzmanElBueno","MadridStation_GuzmanElBueno"),
("Henares","MadridStation_Henares"),    
("HerreraOria","MadridStation_HerreraOria"),
("Hortaleza","MadridStation_Hortaleza"),
("HospitalDoceDeOctubre","MadridStation_HospitalDoceDeOctubre"),
("HospitalDeFuenlabrada","MadridStation_HospitalDeFuenlabrada"),
("HospitalDeMostoles","MadridStation_HospitalDeMostoles"),
("HospitalDeHenares","MadridStation_HospitalDeHenares"),
("HospitalInfantaSofia","MadridStation_HospitalInfantaSofia"),
("HospitalSeveroOchoa","MadridStation_HospitalSeveroOchoa"),
("Ibiza","MadridStation_Ibiza"),
("Iglesia","MadridStation_Iglesia"),
("InfanteDonLuis","MadridStation_InfanteDonLuis"),
("IslasFilipinas","MadridStation_IslasFilipinas"),
("Jarama","MadridStation_Jarama"),
("JoaquinVilumbrales","MadridStation_JoaquinVilumbrales"),
("JoseIsbert","MadridStation_JoseIsbert"),
("JuanDeLaCierva","MadridStation_JuanDeLaCierva"),
("JulianBesteiro","MadridStation_JulianBesteiro"),
("LaAlmudena","MadridStation_LaAlmudena"),
("LaElipa","MadridStation_LaElipa"),
("LaFortuna","MadridStation_LaFortuna"),
("LaGavia","MadridStation_LaGavia"),
("LaGranja","MadridStation_LaGranja"),
("LaLatina","MadridStation_LaLatina"),
("LaMoraleja","MadridStation_LaMoraleja"),
("LaPeseta","MadridStation_LaPeseta"),
("LaPoveda","MadridStation_LaPoveda"),
("LaRambla","MadridStation_LaRambla"),
("Lacoma","MadridStation_Lacoma"),
("Lago","MadridStation_Lago"),
("Laguna","MadridStation_Laguna"),
("LasMusas","MadridStation_LasMusas"),
("LasRosas","MadridStation_LasRosas"),
("LasSuertes","MadridStation_LasSuertes"),
("LasTablas","MadridStation_LasTablas"),
("Lavapies","MadridStation_Lavapies"),
("LeganesCentral","MadridStation_LeganesCentral"),
("Legazpi","MadridStation_Legazpi"),
("Lista","MadridStation_Lista"),
("Loranca","MadridStation_Loranca"),
("LosEspartales","MadridStation_LosEspartales"),
("Lucero","MadridStation_Lucero"),
("Manoteras","MadridStation_Manoteras"),
("ManuelBecerra","MadridStation_ManuelBecerra"),
("ManuelDeFalla","MadridStation_ManuelDeFalla"),
("ManuelaMalasana","MadridStation_ManuelaMalasana"),
("MarDeCristal","MadridStation_MarDeCristal"),
("MariaTudor","MadridStation_MariaTudor"),
("MarquesDeLaValdavia","MadridStation_MarquesDeLaValdavia"),
("MarquesDeVadillo","MadridStation_MarquesDeVadillo"),
("MendezAlvaro","MadridStation_MendezAlvaro"),
("MenendezPelayo","MadridStation_MenendezPelayo"),
("Metropolitano","MadridStation_Metropolitano"),
("MiguelHernandez","MadridStation_MiguelHernandez"),
("Mirasierra","MadridStation_Mirasierra"),
("Moncloa","MadridStation_Moncloa"),
("Montecarmelo","MadridStation_Montecarmelo"),
("Monteprincipe","MadridStation_Monteprincipe"),
("MostolesCentral","MadridStation_MostolesCentral"),
("PlazaDeEspana","MadridStation_PlazaDeEspana"),
("Noviciado","MadridStation_Noviciado"),
("NuevaNumancia","MadridStation_NuevaNumancia"),
("NuevoMundo","MadridStation_NuevoMundo"),
("NuevosMinisterios","MadridStation_NuevosMinisterios"),
("NunezDeBalboa","MadridStation_NunezDeBalboa"),
("Odonnell","MadridStation_Odonnell"),
("Opanel","MadridStation_Opanel"),
("Opera","MadridStation_Opera"),
("Oporto","MadridStation_Oporto"),
("Pacifico","MadridStation_Pacifico"),
("PacoDeLucia","MadridStation_PacoDeLucia"),
("PalasDeRey","MadridStation_PalasDeRey"),
("PalosDeLaFrontera","MadridStation_PalosDeLaFrontera"),
("PanBendito","MadridStation_PanBendito"),
("ParqueDeLasAvenidas","MadridStation_ParqueDeLasAvenidas"),
("ParqueDeLosEstados","MadridStation_ParqueDeLosEstados"),
("ParqueDeSantaMaria","MadridStation_ParqueDeSantaMaria"),
("ParqueEuropa","MadridStation_ParqueEuropa"),
("ParqueLisboa","MadridStation_ParqueLisboa"),
("ParqueOeste","MadridStation_ParqueOeste"),
("Pavones","MadridStation_Pavones"),
("Penagrande","MadridStation_Penagrande"),
("PinarDeChamartin","MadridStation_PinarDeChamartin"),
("PinarDelRey","MadridStation_PinarDelRey"),
("PioXii","MadridStation_PioXii"),
("Piramides","MadridStation_Piramides"),
("Pitis","MadridStation_Pitis"),
("PlazaDeCastilla","MadridStation_PlazaDeCastilla"),
("PlazaEliptica","MadridStation_PlazaEliptica"),
("Portazgo","MadridStation_Portazgo"),
("PozueloOeste","MadridStation_PozueloOeste"),
("Pradillo","MadridStation_Pradillo"),
("PradoDeLaVega","MadridStation_PradoDeLaVega"),
("PradoDelEspino","MadridStation_PradoDelEspino"),
("PradoDelRey","MadridStation_PradoDelRey"),
("PrincipeDeVergara","MadridStation_PrincipeDeVergara"),
("PrincipePio","MadridStation_PrincipePio"),
("Prosperidad","MadridStation_Prosperidad"),
("PuebloNuevo","MadridStation_PuebloNuevo"),
("PuenteDeVallecas","MadridStation_PuenteDeVallecas"),
("PuertaDeArganda","MadridStation_PuertaDeArganda"),
("PuertaDeBoadilla","MadridStation_PuertaDeBoadilla"),
("PuertaDeToledo","MadridStation_PuertaDeToledo"),
("PuertaDelAngel","MadridStation_PuertaDelAngel"),
("PuertaDelSur","MadridStation_PuertaDelSur"),
("Quevedo","MadridStation_Quevedo"),
("Quintana","MadridStation_Quintana"),
("RepublicaArgentina","MadridStation_RepublicaArgentina"),
("Retamares","MadridStation_Retamares"),
("Retiro","MadridStation_Retiro"),
("ReyesCatolicos","MadridStation_ReyesCatolicos"),
("RiosRosas","MadridStation_RiosRosas"),
("RivasFutura","MadridStation_RivasFutura"),
("RivasUrbanizaciones","MadridStation_RivasUrbanizaciones"),
("RivasVaciamadrid","MadridStation_RivasVaciamadrid"),
("RondaDeLaComunicacion","MadridStation_RondaDeLaComunicacion"),
("RubenDario","MadridStation_RubenDario"),
("SainzDeBaranda","MadridStation_SainzDeBaranda"),
("SanBernardo","MadridStation_SanBernardo"),
("SanBlas","MadridStation_SanBlas"),
("SanCipriano","MadridStation_SanCipriano"),
("SanCristobal","MadridStation_SanCristobal"),
("SanFerminorcasur","MadridStation_SanFerminorcasur"),
("SanFernando","MadridStation_SanFernando"),
("SanFrancisco","MadridStation_SanFrancisco"),
("SanLorenzo","MadridStation_SanLorenzo"),
("SanNicasio","MadridStation_SanNicasio"),
("SantiagoBernabeu","MadridStation_SantiagoBernabeu"),
("SantoDomingo","MadridStation_SantoDomingo"),
("Serrano","MadridStation_Serrano"),
("Sevilla","MadridStation_Sevilla"),
("SierraDeGuadalupe","MadridStation_SierraDeGuadalupe"),
("SigloXxi","MadridStation_SigloXxi"),
("Simancas","MadridStation_Simancas"),
("Sol","MadridStation_Sol"),
("SomosaguasCentro","MadridStation_SomosaguasCentro"),
("SomosaguasSur","MadridStation_SomosaguasSur"),
("Suanzes","MadridStation_Suanzes"),
("Tetuan","MadridStation_Tetuan"),
("TirsoDeMolina","MadridStation_TirsoDeMolina"),
("TorreArias","MadridStation_TorreArias"),
("TresOlivos","MadridStation_TresOlivos"),
("Tribunal","MadridStation_Tribunal"),
("UniversidadReyJuanCarlos","MadridStation_UniversidadReyJuanCarlos"),
("Urgel","MadridStation_Urgel"),
("Usera","MadridStation_Usera"),
("Valdeacederas","MadridStation_Valdeacederas"),
("Valdebernardo","MadridStation_Valdebernardo"),
("Valdecarros","MadridStation_Valdecarros"),
("Valdezarza","MadridStation_Valdezarza"),
("Velazquez","MadridStation_Velazquez"),
("Ventas","MadridStation_Ventas"),
("Ventilla","MadridStation_Ventilla"),
("VentorroDelCano","MadridStation_VentorroDelCano"),
("VenturaRodriguez","MadridStation_VenturaRodriguez"),
("Vicalvaro","MadridStation_Vicalvaro"),
("VillaDeVallecas","MadridStation_VillaDeVallecas"),
("VillaverdeAlto","MadridStation_VillaverdeAlto"),
("VillaverdeBajoCruce","MadridStation_VillaverdeBajoCruce"),
("Vinateros","MadridStation_Vinateros"),
("VirgenDelCortijo","MadridStation_VirgenDelCortijo"),
("VistaAlegre","MadridStation_VistaAlegre")
]


def test_uri():
    with open('headers.json', 'r') as fheaders:
        headers = json.load(fheaders)

    url = "https://citymapper.com/api/1/metrodepartures?headways=1&ids="
    for i in ids:
        r = requests.get(url + i[-1], headers=headers)
        j = {}
        if (r.status_code == 200):
            j = json.loads(r.text)
            print('.')
        else:
            print("Estacion mal formada: {}".format(i))

import sqlite3

conn = sqlite3.connect('db_citymapper.db')
c = conn.cursor()

insert_metro_stop = "INSERT INTO metro_stops VALUES (?,?)"

c.executemany(insert_metro_stop,ids)

conn.commit()

conn.close()
